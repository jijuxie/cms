{include file='public/_head'}
{include file='public/_pageHeader'}
<!--主要内容-->

<div class="am-g">
    <div class="am-u-sm-8 am-u-sm-offset-2">
        <form action="/" method="post" class="am-form-inline">
            <div class="am-form-group am-fl">
                <label for="limit_type">
                    按权限类型查找
                </label>
                <select name="limitType" id="limit_type">
                    <option value="0">主父权限</option>
                    <option value="1">方法权限</option>
                    <option value="2">回调权限</option>
                </select>
            </div>
            <div class="am-form-group am-fr">
                <input type="submit" class="am-btn  am-btn-success am-btn-sm" value="查找">
            </div>
        </form>
    </div>
</div>
<div class="am-g">
    <div class="am-u-sm-10 am-u-sm-offset-1">
        <table class="am-table">
            <thead>
            <tr>
                <th>权限名称</th>
                <th>权限类型</th>
                <th>父权限</th>
                <th>对应控制器</th>
                <th>对应方法名</th>
                <th>是否开放</th>
                <th>
                    操作
                </th>
            </tr>
            </thead>
            <tbody>
            {foreach $limitList as $vo }
            <tr>
                <td>{$vo.limit_name}</td>
                <td>{$vo.type_name}</td>
                <td>{$vo.fid}</td>
                <td>{$vo.action}</td>
                <td>{$vo.controller}</td>
                <td>{$vo.if_open}</td>
                <td>
                    <button
                            type="button"
                            class="am-btn am-btn-secondary am-btn-xs"
                            data-am-modal="{target: '#doc-modal-1', closeViaDimmer: 0, width: 400, height: 225}">
                        编辑
                    </button>
                    <div class="am-modal am-modal-no-btn" tabindex="-1" id="doc-modal-1">
                        <div class="am-modal-dialog">
                            <div class="am-modal-hd">编辑本数据
                                <a href="javascript: void(0)" class="am-close am-close-spin"
                                   data-am-modal-close>&times;</a>
                            </div>
                            <div class="am-modal-bd">
                                <div class="am-g">
                                    <form action="" method="post" class="am-form">
                                        <div class="am-form-group">
                                            <label for="edit_name">权限名字</label>
                                            <input type="text" name="name" id="edit_name" value="{$vo.limit_name}">
                                        </div>
                                        <div class="am-form-group">
                                            <label for="edit_type_name">权限类型</label>
                                            <select name="typeName" data-select="{$vo.type_name}" id="edit_type_name">
                                                <option value="1">主父权限</option>
                                                <option value="2">方法权限</option>
                                                <option value="3">回调权限</option>
                                            </select>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                    <button class="am-btn am-btn-danger am-btn-xs" id="ajax_del_form_btn">删除</button>
                    <form action="ajaxDel" id="ajax_del_form" method="post" class="am-form am-inline">
                        <input type="number" id="ajax_del_input" value="{$vo.id}" class="am-hide">
                    </form>

                </td>
            </tr>
            {/foreach}
            </tbody>
        </table>
    </div>
</div>
<div class="am-g">
    {$limiPage}
</div>
<!--分页样式添加-->
<script src="/static/publicJs/venderAdd.js"></script>
<!--公共formjs-->
<script src="/static/publicJs/form.public.js"></script>
<!--引入layer-->
<script src="/static/layer/layer/layer.js"></script>
<script src="/static/layer/putLayer.js"></script>

<script>
$(document).ready(function () {
    $('#ajax_del_form_btn').click(function () {
        putconfirm.ask('确定要删除本条权限吗？',function () {
                $.post("/admin/leader/ajaxDel/",
                    {
                        id:$('#ajax_del_input').val()
                    },
                    function(data,status){
                        if(data.code==0){
                            putconfirm.success('删除成功',function () {
//                                location.href=location.href;
                            })
                        }else{
                            putmsg.error('删除本数据失败！！！')
                        }
                    });
        })
    })
})
</script>
{include file='public/_pageFooter'}